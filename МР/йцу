from tkinter import *
import subprocess
from tkinter import messagebox
from tkinter.ttk import Treeview

processes = []

def run_program():
    global program_entry
    program_path = program_entry.get()
    if program_path:
        try:
            subprocess.Popen(program_path)
            processes.append(program_path)
            update_process_list()
            messagebox.showinfo("Запуск программы", "Программа запущена успешно.")
        except Exception as e:
            messagebox.showerror("Ошибка запуска", str(e))

def terminate_process():
    selected_item = process_tree.focus()
    if selected_item:
        process_tree.delete(selected_item)
        messagebox.showinfo("Завершение процесса", "Запись удалена из списка.")

def update_process_list():
    for item in process_tree.get_children():
        process_tree.delete(item)

    for i, process in enumerate(processes):
        process_tree.insert('', 'end', values=(i, process))

root = Tk()
root.title("Диспетчер задач")
screen_width = root.winfo_screenwidth()
screen_height = root.winfo_screenheight()
root.geometry(f"{screen_width}x{screen_height}+0+0")

# Панель для запуска программы
run_frame = Frame(root)
run_frame.pack(fill=X, padx=20, pady=20)

program_label = Label(run_frame, text="Путь к программе:")
program_label.pack(side=LEFT)

program_entry = Entry(run_frame)
program_entry.pack(side=LEFT, fill=X, expand=True)

run_btn = Button(run_frame, text="Запустить", command=run_program)
run_btn.pack(side=LEFT)

# Область вывода процессов
process_frame = Frame(root)
process_frame.pack(fill=BOTH, expand=True, padx=20, pady=20)

process_tree = Treeview(process_frame, columns=("PID", "Name"), show="headings")
process_tree.column("PID", width=100)
process_tree.column("Name", width=600)
process_tree.heading("PID", text="PID")
process_tree.heading("Name", text="Имя процесса")
process_tree.pack(fill=BOTH, expand=True)

# Кнопка обновления списка процессов
refresh_button = Button(process_frame, text="Обновить", command=update_process_list)
refresh_button.pack(fill=X)

# Кнопка завершения процесса
terminate_button = Button(process_frame, text="Завершить процесс", command=terminate_process)
terminate_button.pack(fill=X)

update_process_list()

root.mainloop()
